<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
<title>Водительское удостоверение</title>
<link rel="stylesheet" href="style.css">
<link rel="manifest" href="manifest.json">
<style>
  body { margin:0; font-family: Arial, sans-serif; }
  #preview {
    margin: -50px 0 20px;
    display: flex;
    justify-content: center;
    align-items: center;
    max-height: 60vh;
    overflow: hidden;
    touch-action: none;
    position: relative;
  }
  .zoomable-image {
    max-width: none;
    max-height: none;
    border-radius: 12px;
    touch-action: none;
    user-select: none;
    position: absolute;
    left: 0;
    top: 0;
    transform-origin: 0 0;
  }
  .copy-icon { height: 18px; width: 22px; cursor: pointer; }
  .tab-content { display: none; }
  .tab-content.active { display: block; }
  .btnfooter { display: flex; gap: 10px; justify-content: center; margin-top: 20px; }
</style>
</head>

<body>
<!-- START: modal for QR -->
<div id="qrOverlay" class="qr-overlay" aria-hidden="true" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.5); z-index:1000;">
  <div class="qr-backdrop" id="qrBackdrop" style="position:absolute; inset:0;"></div>
  <div class="qr-sheet" role="dialog" aria-modal="true" aria-label="Водительское удостоверение" style="position:relative; margin:50px auto; background:white; border-radius:12px; max-width:300px; padding:20px; z-index:1001;">
    <button class="qr-close" id="qrClose" aria-label="Закрыть" style="position:absolute; top:10px; right:10px; background:none; border:none; font-size:24px; cursor:pointer;">&times;</button>
    <div class="qr-sheet-header">
      <h2>Водительские права</h2>
    </div>
    <div class="qr-sheet-body" style="text-align:center;">
      <p class="qr-instruction">Покажите QR-код сотруднику</p>
      <div class="qr-image-wrap">
        <img src="qroo.jpg" alt="QR-код" class="qr-image" style="max-width:100%;">
      </div>
      <p class="qr-or">или скажите код</p>
      <p class="qr-code">080824</p>
    </div>
  </div>
</div>
<!-- END: modal for QR -->

<div class="container" style="padding:20px;">
  <div class="header">
    <div class="title" style="display:flex; align-items:center; gap:10px;">
      <img src="arrow.png" alt="" class="back-icon" style="width:24px; height:24px;"/>
      <h1 class="text-title">Водительские права</h1>
    </div>
    <div class="tab">
      <div class="btntab" style="display:flex; gap:10px; margin-top:10px;">
        <input type="radio" id="tab-btn-1" name="tab-btn" checked hidden>
        <label for="tab-btn-1" style="cursor:pointer; padding:5px 10px; background:#ddd; border-radius:5px;">Документ</label>
        <input type="radio" id="tab-btn-2" name="tab-btn" hidden>
        <label for="tab-btn-2" style="cursor:pointer; padding:5px 10px; background:#ddd; border-radius:5px;">Реквизиты</label>
      </div>
    </div>
  </div>

  <div id="doc" class="tab-content active">
    <div class="middle">
      <div id="preview"></div>
      <div class="btnfooter">
        <button id="btnftr1">
          <img src="qr.png" alt="" class="qrbtn" style="width:20px; vertical-align:middle;"> Предъявить документ
        </button>
        <button id="btnftr2" class="share">
          <img src="upload.png" alt="" class="uploadbtn" style="width:20px; vertical-align:middle;"> Отправить документ
        </button>
      </div>
    </div>
  </div>

  <div id="req" class="tab-content">
    <ul class="rekvizit" style="list-style:none; padding:0;">
      <li><span class="atritem">ФИО</span> <input type="text" maxlength="32" class="rekitem" id="1"><img src="copy.png" class="copy-icon"></li>
      <li><span class="atritem">ИИН</span> <input type="text" maxlength="12" class="rekitem" id="2"><img src="copy.png" class="copy-icon"></li>
      <li><span class="atritem">Номер документа</span> <input type="text" maxlength="9" class="rekitem" id="4"><img src="copy.png" class="copy-icon"></li>
      <li><span class="atritem">Дата выдачи</span> <input type="text" maxlength="10" class="rekitem" id="5"><img src="copy.png" class="copy-icon"></li>
      <li><span class="atritem">Срок действия</span> <input type="text" maxlength="10" class="rekitem" id="6"><img src="copy.png" class="copy-icon"></li>
    </ul>
    <div class="btnfooter">
      <button id="btnftr2" class="share">Отправить реквизиты</button>
    </div>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const preview = document.getElementById("preview");
  const tabBtn1 = document.getElementById("tab-btn-1");
  const tabBtn2 = document.getElementById("tab-btn-2");
  const doc = document.getElementById("doc");
  const req = document.getElementById("req");

  // Автозагрузка фото водительского удостоверения
  function showImage(src) {
    const img = document.createElement("img");
    img.src = src;
    img.classList.add("zoomable-image");
    preview.innerHTML = "";
    preview.appendChild(img);
  }
  showImage("driver_license.png");

  // Табы
  function updateTabs() {
    if(tabBtn1.checked) { doc.classList.add("active"); req.classList.remove("active"); preview.style.display="flex"; }
    else { req.classList.add("active"); doc.classList.remove("active"); preview.style.display="none"; }
  }
  tabBtn1.addEventListener("change", updateTabs);
  tabBtn2.addEventListener("change", updateTabs);
  updateTabs();

  // Сохранение реквизитов
  document.querySelectorAll('.rekvizit input').forEach((input,index)=>{
    const saved = localStorage.getItem('rekvizit'+index);
    if(saved) input.value = saved;
    input.addEventListener('input',()=>localStorage.setItem('rekvizit'+index,input.value));
  });

  // QR modal
  const openBtn = document.getElementById('btnftr1');
  const overlay = document.getElementById('qrOverlay');
  const closeBtn = document.getElementById('qrClose');
  const backdrop = document.getElementById('qrBackdrop');

  function openModal() { overlay.style.display='block'; document.body.style.overflow='hidden'; }
  function closeModal() { overlay.style.display='none'; document.body.style.overflow=''; }

  openBtn.addEventListener('click',e=>{ e.preventDefault(); openModal(); });
  closeBtn.addEventListener('click',closeModal);
  backdrop.addEventListener('click',closeModal);
  overlay.addEventListener('click',e=>{
